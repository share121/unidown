import CryptoJS from "crypto-js";

function md5cycle(_0x3100b2, _0x583a36) {
  let [_0x499cce, _0x199574, _0x381811, _0x3dbbac] = _0x3100b2;

  function _0x551fc6(
    _0x2a3a98,
    _0x80e4c2,
    _0x3c281c,
    _0x5b4532,
    _0x3d033b,
    _0x5922a2,
    _0x14493a,
  ) {
    _0x2a3a98 =
      (_0x2a3a98 +
        ((_0x80e4c2 & _0x3c281c) | (~_0x80e4c2 & _0x5b4532)) +
        _0x3d033b +
        _0x14493a) |
      0x0;
    return (
      (((_0x2a3a98 << _0x5922a2) | (_0x2a3a98 >>> (0x20 - _0x5922a2))) +
        _0x80e4c2) |
      0x0
    );
  }

  function _0x1652e4(
    _0x3edd92,
    _0x30f6c9,
    _0xe4cb7d,
    _0x4e676e,
    _0xb9d37,
    _0x25eaa2,
    _0x3998d1,
  ) {
    _0x3edd92 =
      (_0x3edd92 +
        ((_0x30f6c9 & _0x4e676e) | (_0xe4cb7d & ~_0x4e676e)) +
        _0xb9d37 +
        _0x3998d1) |
      0x0;
    return (
      (((_0x3edd92 << _0x25eaa2) | (_0x3edd92 >>> (0x20 - _0x25eaa2))) +
        _0x30f6c9) |
      0x0
    );
  }

  function _0x2cd8cc(
    _0x1c6842,
    _0x3594f6,
    _0x5afddf,
    _0x2478d6,
    _0x40471a,
    _0x56c938,
    _0x25b7df,
  ) {
    _0x1c6842 =
      (_0x1c6842 +
        (_0x3594f6 ^ _0x5afddf ^ _0x2478d6) +
        _0x40471a +
        _0x25b7df) |
      0x0;
    return (
      (((_0x1c6842 << _0x56c938) | (_0x1c6842 >>> (0x20 - _0x56c938))) +
        _0x3594f6) |
      0x0
    );
  }

  function _0x1b0be2(
    _0x2fbe76,
    _0x47e98b,
    _0x40bff7,
    _0x32b304,
    _0x4c3609,
    _0x16deba,
    _0x8810cb,
  ) {
    _0x2fbe76 =
      (_0x2fbe76 +
        (_0x40bff7 ^ (_0x47e98b | ~_0x32b304)) +
        _0x4c3609 +
        _0x8810cb) |
      0x0;
    return (
      (((_0x2fbe76 << _0x16deba) | (_0x2fbe76 >>> (0x20 - _0x16deba))) +
        _0x47e98b) |
      0x0
    );
  }

  _0x499cce = _0x551fc6(
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x583a36[0x0],
    0x7,
    -0x28955b88,
  );
  _0x3dbbac = _0x551fc6(
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x583a36[0x1],
    0xc,
    -0x173848aa,
  );
  _0x381811 = _0x551fc6(
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x583a36[0x2],
    0x11,
    0x242070db,
  );
  _0x199574 = _0x551fc6(
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x583a36[0x3],
    0x16,
    -0x3e423112,
  );
  _0x499cce = _0x551fc6(
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x583a36[0x4],
    0x7,
    -0xa83f051,
  );
  _0x3dbbac = _0x551fc6(
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x583a36[0x5],
    0xc,
    0x4787c62a,
  );
  _0x381811 = _0x551fc6(
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x583a36[0x6],
    0x11,
    -0x57cfb9ed,
  );
  _0x199574 = _0x551fc6(
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x583a36[0x7],
    0x16,
    -0x2b96aff,
  );
  _0x499cce = _0x551fc6(
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x583a36[0x8],
    0x7,
    0x698098d8,
  );
  _0x3dbbac = _0x551fc6(
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x583a36[0x9],
    0xc,
    -0x74bb0851,
  );
  _0x381811 = _0x551fc6(
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x583a36[0xa],
    0x11,
    -0xa44f,
  );
  _0x199574 = _0x551fc6(
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x583a36[0xb],
    0x16,
    -0x76a32842,
  );
  _0x499cce = _0x551fc6(
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x583a36[0xc],
    0x7,
    0x6b901122,
  );
  _0x3dbbac = _0x551fc6(
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x583a36[0xd],
    0xc,
    -0x2678e6d,
  );
  _0x381811 = _0x551fc6(
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x583a36[0xe],
    0x11,
    -0x5986bc72,
  );
  _0x199574 = _0x551fc6(
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x583a36[0xf],
    0x16,
    0x49b40821,
  );
  _0x499cce = _0x1652e4(
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x583a36[0x1],
    0x5,
    -0x9e1da9e,
  );
  _0x3dbbac = _0x1652e4(
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x583a36[0x6],
    0x9,
    -0x3fbf4cc0,
  );
  _0x381811 = _0x1652e4(
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x583a36[0xb],
    0xe,
    0x265e5a51,
  );
  _0x199574 = _0x1652e4(
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x583a36[0x0],
    0x14,
    -0x16493856,
  );
  _0x499cce = _0x1652e4(
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x583a36[0x5],
    0x5,
    -0x29d0efa3,
  );
  _0x3dbbac = _0x1652e4(
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x583a36[0xa],
    0x9,
    0x2441453,
  );
  _0x381811 = _0x1652e4(
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x583a36[0xf],
    0xe,
    -0x275e197f,
  );
  _0x199574 = _0x1652e4(
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x583a36[0x4],
    0x14,
    -0x182c0438,
  );
  _0x499cce = _0x1652e4(
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x583a36[0x9],
    0x5,
    0x21e1cde6,
  );
  _0x3dbbac = _0x1652e4(
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x583a36[0xe],
    0x9,
    -0x3cc8f82a,
  );
  _0x381811 = _0x1652e4(
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x583a36[0x3],
    0xe,
    -0xb2af279,
  );
  _0x199574 = _0x1652e4(
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x583a36[0x8],
    0x14,
    0x455a14ed,
  );
  _0x499cce = _0x1652e4(
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x583a36[0xd],
    0x5,
    -0x561c16fb,
  );
  _0x3dbbac = _0x1652e4(
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x583a36[0x2],
    0x9,
    -0x3105c08,
  );
  _0x381811 = _0x1652e4(
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x583a36[0x7],
    0xe,
    0x676f02d9,
  );
  _0x199574 = _0x1652e4(
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x583a36[0xc],
    0x14,
    -0x72d5b376,
  );
  _0x499cce = _0x2cd8cc(
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x583a36[0x5],
    0x4,
    -0x5c6be,
  );
  _0x3dbbac = _0x2cd8cc(
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x583a36[0x8],
    0xb,
    -0x788e097f,
  );
  _0x381811 = _0x2cd8cc(
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x583a36[0xb],
    0x10,
    0x6d9d6122,
  );
  _0x199574 = _0x2cd8cc(
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x583a36[0xe],
    0x17,
    -0x21ac7f4,
  );
  _0x499cce = _0x2cd8cc(
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x583a36[0x1],
    0x4,
    -0x5b4115bc,
  );
  _0x3dbbac = _0x2cd8cc(
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x583a36[0x4],
    0xb,
    0x4bdecfa9,
  );
  _0x381811 = _0x2cd8cc(
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x583a36[0x7],
    0x10,
    -0x944b4a0,
  );
  _0x199574 = _0x2cd8cc(
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x583a36[0xa],
    0x17,
    -0x41404390,
  );
  _0x499cce = _0x2cd8cc(
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x583a36[0xd],
    0x4,
    0x289b7ec6,
  );
  _0x3dbbac = _0x2cd8cc(
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x583a36[0x0],
    0xb,
    -0x155ed806,
  );
  _0x381811 = _0x2cd8cc(
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x583a36[0x3],
    0x10,
    -0x2b10cf7b,
  );
  _0x199574 = _0x2cd8cc(
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x583a36[0x6],
    0x17,
    0x4881d05,
  );
  _0x499cce = _0x2cd8cc(
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x583a36[0x9],
    0x4,
    -0x262b2fc7,
  );
  _0x3dbbac = _0x2cd8cc(
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x583a36[0xc],
    0xb,
    -0x1924661b,
  );
  _0x381811 = _0x2cd8cc(
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x583a36[0xf],
    0x10,
    0x1fa27cf8,
  );
  _0x199574 = _0x2cd8cc(
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x583a36[0x2],
    0x17,
    -0x3b53a99b,
  );
  _0x499cce = _0x1b0be2(
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x583a36[0x0],
    0x6,
    -0xbd6ddbc,
  );
  _0x3dbbac = _0x1b0be2(
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x583a36[0x7],
    0xa,
    0x432aff97,
  );
  _0x381811 = _0x1b0be2(
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x583a36[0xe],
    0xf,
    -0x546bdc59,
  );
  _0x199574 = _0x1b0be2(
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x583a36[0x5],
    0x15,
    -0x36c5fc7,
  );
  _0x499cce = _0x1b0be2(
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x583a36[0xc],
    0x6,
    0x655b59c3,
  );
  _0x3dbbac = _0x1b0be2(
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x583a36[0x3],
    0xa,
    -0x70f3336e,
  );
  _0x381811 = _0x1b0be2(
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x583a36[0xa],
    0xf,
    -0x100b83,
  );
  _0x199574 = _0x1b0be2(
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x583a36[0x1],
    0x15,
    -0x7a7ba22f,
  );
  _0x499cce = _0x1b0be2(
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x583a36[0x8],
    0x6,
    0x6fa87e4f,
  );
  _0x3dbbac = _0x1b0be2(
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x583a36[0xf],
    0xa,
    -0x1d31920,
  );
  _0x381811 = _0x1b0be2(
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x583a36[0x6],
    0xf,
    -0x5cfebcec,
  );
  _0x199574 = _0x1b0be2(
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x583a36[0xd],
    0x15,
    0x4e0811a1,
  );
  _0x499cce = _0x1b0be2(
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x583a36[0x4],
    0x6,
    -0x8ac817e,
  );
  _0x3dbbac = _0x1b0be2(
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x381811,
    _0x583a36[0xb],
    0xa,
    -0x42c50dcb,
  );
  _0x381811 = _0x1b0be2(
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x199574,
    _0x583a36[0x2],
    0xf,
    0x2ad7d2bb,
  );
  _0x199574 = _0x1b0be2(
    _0x199574,
    _0x381811,
    _0x3dbbac,
    _0x499cce,
    _0x583a36[0x9],
    0x15,
    -0x14792c6f,
  );
  _0x3100b2[0x0] = (_0x3100b2[0x0] + _0x499cce) | 0x0;
  _0x3100b2[0x1] = (_0x3100b2[0x1] + _0x199574) | 0x0;
  _0x3100b2[0x2] = (_0x3100b2[0x2] + _0x381811) | 0x0;
  _0x3100b2[0x3] = (_0x3100b2[0x3] + _0x3dbbac) | 0x0;
}

function md5blk(_0x39f11b) {
  const _0x388f1b = [];
  for (let _0x3d9c5b = 0x0; _0x3d9c5b < 0x40; _0x3d9c5b += 0x4) {
    _0x388f1b[_0x3d9c5b >> 0x2] =
      _0x39f11b.charCodeAt(_0x3d9c5b) +
      (_0x39f11b.charCodeAt(_0x3d9c5b + 0x1) << 0x8) +
      (_0x39f11b.charCodeAt(_0x3d9c5b + 0x2) << 0x10) +
      (_0x39f11b.charCodeAt(_0x3d9c5b + 0x3) << 0x18);
  }
  return _0x388f1b;
}

function md51(_0x5d49e7) {
  let _0x540f04 = _0x5d49e7.length;
  let _0x55aaf2 = [0x67452301, -0x10325477, -0x67452302, 0x10325476];
  let _0x266271;
  let _0x33d8fc;
  for (_0x266271 = 0x40; _0x266271 <= _0x540f04; _0x266271 += 0x40) {
    md5cycle(
      _0x55aaf2,
      md5blk(_0x5d49e7.substring(_0x266271 - 0x40, _0x266271)),
    );
  }
  _0x5d49e7 = _0x5d49e7.substring(_0x266271 - 0x40);
  _0x33d8fc = new Array(0x10).fill(0x0);
  for (_0x266271 = 0x0; _0x266271 < _0x5d49e7.length; _0x266271++) {
    _0x33d8fc[_0x266271 >> 0x2] |=
      _0x5d49e7.charCodeAt(_0x266271) << ((_0x266271 % 0x4) << 0x3);
  }
  _0x33d8fc[_0x266271 >> 0x2] |= 0x80 << ((_0x266271 % 0x4) << 0x3);
  if (_0x266271 > 0x37) {
    md5cycle(_0x55aaf2, _0x33d8fc);
    _0x33d8fc = new Array(0x10).fill(0x0);
  }
  const _0x57a291 = _0x540f04 * 0x8;
  _0x33d8fc[0xe] = _0x57a291 & 0xffffffff;
  _0x33d8fc[0xf] = (_0x57a291 / 0x100000000) | 0x0;
  md5cycle(_0x55aaf2, _0x33d8fc);
  return _0x55aaf2;
}

function rhex(_0x274cf7) {
  let _0x571b34 = "";
  for (let _0x5c6a3d = 0x0; _0x5c6a3d < 0x4; _0x5c6a3d++) {
    _0x571b34 +=
      "0123456789abcdef"[(_0x274cf7 >> (_0x5c6a3d * 0x8 + 0x4)) & 0xf] +
      "0123456789abcdef"[(_0x274cf7 >> (_0x5c6a3d * 0x8)) & 0xf];
  }
  return _0x571b34;
}

function md5(_0x4aae21) {
  const _0x22e779 = md51(_0x4aae21);
  return _0x22e779.map(rhex).join("");
}

function generateSignatureWithMD5(_0x342947, _0x292229, _0x1ed416, _0x3d330d) {
  const _0x11f8e2 = Object.keys(_0x342947).sort();
  const _0x4d34ae = _0x11f8e2
    .map((_0x5b3e4c) => _0x5b3e4c + "=" + _0x342947[_0x5b3e4c])
    .join("&");
  const _0x378502 =
    _0x4d34ae +
    "&salt=" +
    _0x292229 +
    "&ts=" +
    _0x1ed416 +
    "&secret=" +
    _0x3d330d;
  const _0x3c5c86 = md5(_0x378502);
  return _0x3c5c86.replace(/b/g, "#").replace(/d/g, "F").replace(/#/g, "C");
}

/**
 * 生成认证 Token
 * @param {Object} data - 包含请求数据的对象
 * @param {String} secret - 密钥
 * @returns {Object} 包含原始数据、time、key 和 sign 的对象
 */
function generateAuthToken(_0x2b7228, _0x5b4aea) {
  const _0x42c5c6 = Math.floor(Date.now() / 0x3e8); // 当前时间戳(秒)
  const _0x164ab6 = Math.random().toString(0x24).substring(0x2, 0xa); // 随机盐
  const _0x13a6f9 = generateSignatureWithMD5(
    _0x2b7228,
    _0x164ab6,
    _0x42c5c6,
    _0x5b4aea,
  );
  return {
    ..._0x2b7228,
    time: _0x42c5c6,
    key: _0x164ab6,
    sign: _0x13a6f9,
  };
}

function base64CustomDecode(_0x33825e) {
  return _0x33825e
    .split("")
    .map((_0x2ab9ee) => {
      const _0x4448db =
        "ZYXABCDEFGHIJKLMNOPQRSTUVWzyxabcdefghijklmnopqrstuvw9876543210-_".indexOf(
          _0x2ab9ee,
        );
      return _0x4448db === -0x1
        ? _0x2ab9ee
        : "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[
            _0x4448db
          ];
    })
    .join("");
}

/**
 * 块反转字符串
 * @param {String} _0x431721 输入字符串
 * @param {Number} _0x69a67d 块大小，默认 8
 */
function blockReverse(_0x431721, _0x69a67d = 0x8) {
  let _0x731056 = "";
  for (
    let _0x5ad8cc = 0x0;
    _0x5ad8cc < _0x431721.length;
    _0x5ad8cc += _0x69a67d
  ) {
    const _0x5e6107 = _0x431721.slice(_0x5ad8cc, _0x5ad8cc + _0x69a67d);
    _0x731056 += _0x5e6107.split("").reverse().join("");
  }
  return _0x731056;
}

/**
 * XOR 字符串
 * @param {String} _0x15d688 输入字符串
 * @param {Number} _0x37e3dc XOR Key，默认 0x5a (90)
 */
function xorString(_0x15d688, _0x37e3dc = 0x5a) {
  const _0x42e752 = [];
  for (let _0x271fb6 = 0x0; _0x271fb6 < _0x15d688.length; _0x271fb6++) {
    _0x42e752.push(
      String.fromCharCode(_0x15d688.charCodeAt(_0x271fb6) ^ _0x37e3dc),
    );
  }
  return _0x42e752.join("");
}

/**
 * AES 解密
 * @param {String} encryptedData Base64 格式的加密数据
 * @param {String} ivData Base64 格式的 IV
 * @param {String} secretKey 解密密钥
 */
function aesDecrypt(_0x10f5b9, _0x495683, _0xe8ed75) {
  // 检查 CryptoJS 是否存在
  if (typeof CryptoJS === "undefined") {
    throw new Error(
      "CryptoJS library is required for aesDecrypt. Please include crypto-js in your project.",
    );
  }

  const _0x974af4 = CryptoJS.enc.Utf8.parse(_0xe8ed75);
  const _0x5dec08 = CryptoJS.enc.Base64.parse(_0x495683);
  const _0x4508ab = CryptoJS.enc.Base64.parse(_0x10f5b9);
  const _0x4f4812 = CryptoJS.AES.decrypt(
    {
      ciphertext: _0x4508ab,
    },
    _0x974af4,
    {
      iv: _0x5dec08,
      mode: CryptoJS.mode.CBC,
      padding: CryptoJS.pad.Pkcs7,
    },
  );
  const _0x373047 = _0x4f4812.toString(CryptoJS.enc.Utf8);
  return JSON.parse(_0x373047);
}

/**
 * 解密并输出数据
 * @param {String} encryptedDataBase64 加密后的数据 (Base64)
 * @param {String} ivBase64 IV 向量 (Base64)
 * @param {String} secretKey 密钥字符串
 * @returns {Object} 解密后的 JSON 对象
 */
function generateOutput(_0x57ef7e, _0x2dbd62, _0xe8ed5f) {
  try {
    // 1. Base64 解码
    let _0x1fd046 = atob(_0x57ef7e);
    let _0x9b2e4d = atob(_0x2dbd62);

    // 2. XOR 解密 (Key: 0x5a)
    _0x1fd046 = xorString(_0x1fd046);
    _0x9b2e4d = xorString(_0x9b2e4d);

    // 3. 块反转 (Block size: 8)
    _0x1fd046 = blockReverse(_0x1fd046);
    _0x9b2e4d = blockReverse(_0x9b2e4d);

    // 4. 自定义 Base64 转标准 Base64
    _0x1fd046 = base64CustomDecode(_0x1fd046);
    _0x9b2e4d = base64CustomDecode(_0x9b2e4d);

    // 5. AES 解密
    return aesDecrypt(_0x1fd046, _0x9b2e4d, _0xe8ed5f);
  } catch (_0x57fab0) {
    throw _0x57fab0;
  }
}

export function genReq(url) {
  let params = { requestURL: url };
  let secret = "TI52hwg30V08ycUo9";
  let token = generateAuthToken(params, secret);
  let authToken = token.sign;
  delete token.sign;
  return { body: JSON.stringify(token), auth: authToken };
}

export function genOuput(resp) {
  resp = JSON.parse(resp);
  resp = generateOutput(
    resp.data,
    resp.key,
    "93838338562359368888868323563256",
  );
  return {
    title: resp.title,
    url: resp.videos[0].video_fullinfo.at(-1).url,
  };
}
